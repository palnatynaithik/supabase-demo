<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Students Table Demo</title>
</head>
<body>
  <h1>Students</h1>

  <form id="addForm">
    <input type="text" id="name" placeholder="Name" required>
    <input type="number" id="grade" placeholder="Grade" required>
    <button type="submit">Add Student</button>
  </form>

  <h2>All Students:</h2>
  <ul id="studentList"></ul>

  <script type="module">
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm'

    // ðŸ”‘ Replace these with your Supabase project info
    const supabaseUrl = 'https://lbvhhioxniycjyrpcrnc.supabase.co'
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxidmhoaW94bml5Y2p5cnBjcm5jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk1ODk0NzUsImV4cCI6MjA3NTE2NTQ3NX0.rOOdSAESpdD93Lc-SrjaVg3U3Xse295gL9kq8Y0iaR4'
    const supabase = createClient(supabaseUrl, supabaseKey)

    const studentList = document.getElementById('studentList')
    const addForm = document.getElementById('addForm')

    // Fetch and display all students
    async function fetchStudents() {
      const { data, error } = await supabase.from('students').select('*').order('id')
      if (error) return console.error('Error fetching students:', error)

      studentList.innerHTML = ''
      data.forEach(student => {
        const li = document.createElement('li')
        li.textContent = `ID: ${student.id}, Name: ${student.name}, Grade: ${student.grade}, Created At: ${new Date(student.created_at).toLocaleString()}`
        studentList.appendChild(li)
      })
    }

    // Add new student
    addForm.addEventListener('submit', async (e) => {
      e.preventDefault()
      const name = document.getElementById('name').value
      const grade = parseInt(document.getElementById('grade').value)

      const { error } = await supabase.from('students').insert([{ name, grade }])
      if (error) return console.error('Error adding student:', error)

      addForm.reset()
      fetchStudents()
    })

    // Load students on page load
    fetchStudents()
  </script>
</body>
</html>

